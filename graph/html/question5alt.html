<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Test</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.0.0/js/all.js"></script>
</head>
<body>
<style type="text/css">
    .graph {
        width: 50%;
        margin: 0 auto;
    }
</style>
<section class="section">
    <div class="container">
        <h1 class="title is-1">Crimes cases in San Fransisco</h1>
        <div class="tabs is-centered is-boxed">
            <ul>
                <li><a href="index.html">Index</a></li>
                <li><a href="question1.html">Question 1</a></li>
                <li><a href="question2.html">Question 2</a></li>
                <li><a href="question3.html">Question 3</a></li>
                <li><a href="question4.html">Question 4</a></li>
                <li><a href="question5.html">Question 5</a></li>
                <li class="is-active"><a href="question5alt.html">Question 5+</a></li>
            </ul>
        </div>

        <h3 class="title is-3 is-spaced">Question 5 alternative</h3>
        <h5 class="subtitle is-5 is-spaced">Donnez le top 3 des mois les plus concernés par les cas de crimes, pour chaque crime</h5>
        <h3 class="title is-3 is-spaced">Données techniques</h3>
        <p>Cette éxécution a été réalisée sur le cluster hadoop de l'ufr</p>
        <br>
        <h5 class="title is-5">Temps de traitement</h5>
        <p>
            Total time spent by all map tasks (ms)=260720<br>
            Total time spent by all reduce tasks (ms)=14620
        </p><br>
        <p>
            Map input records=6486072<br>
            Map output records=3999
        </p><br>
        <p>
            Reduce input records=3999<br>
            Reduce output records=103
        </p><br>
        <h5 class="title is-5">Mapper</h5>
        <p>
            Le mapper instancie une Map dans sa partie setup()<br>
            Dans la partie map() il récupère le mois et crimes de chaque ligne et ajoute cette clé (crime et mois) à la Map instancié, ce qui lui permet de compter le nombre d'occurance de chaque crime pour chaque mois.<br>
            Enfin dans la partie cleanUp(), il parcours les entrées de la Map pour écrire dans le context des tuples de forme (crime, "mois:nombre d'occurences") qui seront traités par le reducer<br><br>
        </p><br>
        <h5 class="title is-5">Reducer</h5>
        <p>
            Le reducer instancie une PriorityQueue de taille 3 dans sa phase de reduce()<br>
            Il fait ensuite pour chaque clé (crime) le total du compte du nombre de crime pour chaque mois à l'aide d'une Map. Enfin il ajoute tous les tuples (mois, nombre d'occurences) de la Map à la priority queue<br>
            Ensuite il parcours les trois éléments (maximum) de la priority queue, pour écrire dans le context des lignes de la forme (crime:mois, count) (crime étant la clé, mois et count étant les informations qui étaient dans la Map)<br>
            <br>
            Le reducer fais cela pour chaque clé (crime) étant donné que tout est dans la partie reducer, ainsi on peut avoir un top 3 des moins les plus criminels par crime.
        </p><br>

        <h3 class="title is-3 is-spaced">Graphiques</h3>
        <div id="container-graph"></div>
    </div>
</section>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type='text/javascript' src='../js/question5alt.js'></script>
</body>
</html>